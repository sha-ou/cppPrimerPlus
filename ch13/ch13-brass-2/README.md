# 13.4.3 有关虚函数注意事项

## 1. 已经学习的虚函数的要点

- 基类中使用关键字virtual使方法为虚方法，虚方法是“遗传”的
- 当使用基类指针或者引用调虚方法时，程序会调为对象类型定义的方法，而不是指针类型定义的方法，这叫做动态联编
- 如果定义的类将被用作基类，则应该将在派生类中要重新实现的方法声明为虚方法

## 2. 虚函数的新内容

- 构造函数不可以声明为虚函数
    创建派生类对象时，调用的是派生类的构造函数而不是基类的构造函数，然后派生类的构造函数调用基类的构造函数

- 析构函数应该是虚函数，除非没有继承与被继承的关系
    如果一个类没有继承与被继承的关系，析构函数可以声明为虚函数，也可以不声明为虚函数。区别在于，声明为虚函数后使用动态联编，不声明为虚函数使用静态联编，静态联编效率更高。
    而类具有继承与被继承的关系时，析构函数必须是虚函数。这样通过基类指针或引用析构派生类对象时，才会调派生类的析构函数。

- 友元函数不可以声明为虚函数，因为友元函数不是类成员函数

- 派生类没有重新实现虚函数的情况
    派生类没有重新实现虚函数时，将调用该函数的基类版本。
    如果派生类位于派生链中，则使用最新的虚函数版本，除非基类版本是隐藏的。

- 重新定义虚函数将隐藏基类虚函数
    重新定义继承的方法不是重载。
    如果重新定义派生类中的函数，将不只是使用相同的函数列表覆盖基类声明，无论参数列表是否相同，重新定义将隐藏所有的同名基类方法。
    * 如果重新定义继承的方法，应该保证与原来的原型完全相同。如果返回类型是基类引用或指针，可以修改为派生类引用或指针
    * 如果基类声明被重载了，派生类中应该重新定义所有的重载版本
